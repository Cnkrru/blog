/* 响应式设计优化 - 增强版本 */

/* 响应式字体系统 */
:root {
    /* 基础字体大小 - 使用clamp实现流体排版 */
    --font-size-xs: clamp(0.75rem, 1.5vw + 0.5rem, 0.875rem);
    --font-size-sm: clamp(0.875rem, 2vw + 0.5rem, 1rem);
    --font-size-md: clamp(1rem, 2.5vw + 0.5rem, 1.125rem);
    --font-size-lg: clamp(1.125rem, 3vw + 0.5rem, 1.25rem);
    --font-size-xl: clamp(1.25rem, 3.5vw + 0.5rem, 1.5rem);
    --font-size-2xl: clamp(1.5rem, 4vw + 0.5rem, 2rem);
    --font-size-3xl: clamp(2rem, 5vw + 0.5rem, 2.5rem);
    --font-size-4xl: clamp(2.5rem, 6vw + 0.5rem, 3rem);
    
    /* 响应式间距系统 */
    --spacing-xs: clamp(0.25rem, 1vw, 0.5rem);
    --spacing-sm: clamp(0.5rem, 2vw, 1rem);
    --spacing-md: clamp(1rem, 3vw, 1.5rem);
    --spacing-lg: clamp(1.5rem, 4vw, 2rem);
    --spacing-xl: clamp(2rem, 5vw, 3rem);
    --spacing-2xl: clamp(3rem, 6vw, 4rem);
    
    /* 响应式容器宽度 */
    --container-xs: 100%;
    --container-sm: 540px;
    --container-md: 720px;
    --container-lg: 960px;
    --container-xl: 1140px;
    --container-2xl: 1320px;
}

/* 基础响应式样式 */
html {
    /* 改善文本渲染 */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    
    /* 防止横向滚动 */
    overflow-x: hidden;
}

body {
    font-size: var(--font-size-md);
    line-height: 1.6;
    
    /* 防止横向滚动 */
    overflow-x: hidden;
    
    /* 改善触摸滚动 */
    -webkit-overflow-scrolling: touch;
}

/* 响应式容器系统 */
.container {
    width: 100%;
    padding-left: var(--spacing-md);
    padding-right: var(--spacing-md);
    margin-left: auto;
    margin-right: auto;
}

.container-fluid {
    width: 100%;
    padding-left: var(--spacing-sm);
    padding-right: var(--spacing-sm);
}

/* 标题响应式样式 */
h1, .h1 {
    font-size: var(--font-size-4xl);
    line-height: 1.1;
    font-weight: 800;
}

h2, .h2 {
    font-size: var(--font-size-3xl);
    line-height: 1.2;
    font-weight: 700;
}

h3, .h3 {
    font-size: var(--font-size-2xl);
    line-height: 1.3;
    font-weight: 600;
}

h4, .h4 {
    font-size: var(--font-size-xl);
    line-height: 1.4;
    font-weight: 600;
}

h5, .h5 {
    font-size: var(--font-size-lg);
    line-height: 1.5;
    font-weight: 500;
}

h6, .h6 {
    font-size: var(--font-size-md);
    line-height: 1.5;
    font-weight: 500;
}

/* 响应式网格系统 */
.row {
    display: flex;
    flex-wrap: wrap;
    margin-left: calc(var(--spacing-sm) * -0.5);
    margin-right: calc(var(--spacing-sm) * -0.5);
}

.col {
    flex: 1 0 0%;
    padding-left: calc(var(--spacing-sm) * 0.5);
    padding-right: calc(var(--spacing-sm) * 0.5);
}

/* 响应式工具类 */
.d-none { display: none !important; }
.d-block { display: block !important; }
.d-flex { display: flex !important; }
.d-grid { display: grid !important; }

.text-center { text-align: center !important; }
.text-left { text-align: left !important; }
.text-right { text-align: right !important; }

.w-100 { width: 100% !important; }
.h-100 { height: 100% !important; }

/* 超小屏幕设备 (< 576px) */
@media (max-width: 575.98px) {
    :root {
        --spacing-md: 0.75rem;
        --spacing-lg: 1rem;
        --spacing-xl: 1.5rem;
    }
    
    .container {
        max-width: var(--container-xs);
        padding-left: var(--spacing-sm);
        padding-right: var(--spacing-sm);
    }
    
    /* 导航优化 */
    .sidebar {
        width: 90vw;
        max-width: 280px;
    }
    
    /* 文章内容优化 */
    .article-content {
        padding: var(--spacing-sm);
        font-size: var(--font-size-sm);
    }
    
    .article-title {
        font-size: var(--font-size-2xl);
        margin-bottom: var(--spacing-sm);
    }
    
    /* 工具卡片优化 */
    .tools-grid {
        grid-template-columns: 1fr;
        gap: var(--spacing-sm);
    }
    
    .tool-card {
        padding: var(--spacing-sm);
        min-height: 140px;
    }
    
    .tool-icon {
        font-size: 2rem;
        margin-bottom: var(--spacing-sm);
    }
    
    /* 按钮优化 */
    .btn {
        padding: var(--spacing-sm) var(--spacing-md);
        font-size: var(--font-size-sm);
        min-height: 44px;
    }
    
    /* 表格响应式处理 */
    .table-responsive {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    table {
        min-width: 600px;
    }
    
    /* 代码块优化 */
    pre {
        font-size: var(--font-size-xs);
        padding: var(--spacing-sm);
        overflow-x: auto;
    }
    
    /* 隐藏/显示工具类 */
    .d-xs-none { display: none !important; }
    .d-xs-block { display: block !important; }
    .d-xs-flex { display: flex !important; }
}

/* 小屏幕设备 (576px - 767.98px) */
@media (min-width: 576px) and (max-width: 767.98px) {
    .container {
        max-width: var(--container-sm);
    }
    
    .tools-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: var(--spacing-md);
    }
    
    .d-sm-none { display: none !important; }
    .d-sm-block { display: block !important; }
    .d-sm-flex { display: flex !important; }
}

/* 中等屏幕设备 (768px - 991.98px) */
@media (min-width: 768px) and (max-width: 991.98px) {
    .container {
        max-width: var(--container-md);
    }
    
    /* 导航菜单优化 */
    .sidebar {
        width: 300px;
    }
    
    /* 文章内容优化 */
    .article-content {
        padding: var(--spacing-lg);
    }
    
    /* 工具网格优化 */
    .tools-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: var(--spacing-lg);
    }
    
    .d-md-none { display: none !important; }
    .d-md-block { display: block !important; }
    .d-md-flex { display: flex !important; }
}

/* 大屏幕设备 (992px - 1199.98px) */
@media (min-width: 992px) and (max-width: 1199.98px) {
    .container {
        max-width: var(--container-lg);
    }
    
    .tools-grid {
        grid-template-columns: repeat(3, 1fr);
    }
    
    .d-lg-none { display: none !important; }
    .d-lg-block { display: block !important; }
    .d-lg-flex { display: flex !important; }
}

/* 超大屏幕设备 (1200px - 1399.98px) */
@media (min-width: 1200px) and (max-width: 1399.98px) {
    .container {
        max-width: var(--container-xl);
    }
    
    .d-xl-none { display: none !important; }
    .d-xl-block { display: block !important; }
    .d-xl-flex { display: flex !important; }
}

/* 超超大屏幕设备 (≥ 1400px) */
@media (min-width: 1400px) {
    .container {
        max-width: var(--container-2xl);
    }
    
    .d-xxl-none { display: none !important; }
    .d-xxl-block { display: block !important; }
    .d-xxl-flex { display: flex !important; }
}

/* 触摸设备优化 */
@media (hover: none) and (pointer: coarse) {
    /* 触摸设备上的交互优化 */
    button, a, .clickable, .tool-card {
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }
    
    /* 增大触摸目标大小 */
    button, a, .btn {
        min-height: 44px;
        min-width: 44px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    /* 移除悬停效果 */
    .tool-card:hover,
    .btn:hover,
    .control-btn:hover {
        transform: none;
    }
    
    /* 优化点击反馈 */
    .tool-card:active {
        transform: scale(0.98);
        transition: transform 0.1s ease;
    }
    
    .btn:active {
        transform: scale(0.95);
        transition: transform 0.1s ease;
    }
}

/* 高分辨率屏幕优化 */
@media (min-resolution: 192dpi), (min-resolution: 2dppx) {
    /* 高分辨率屏幕上的图像优化 */
    img {
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
    }
    
    /* 优化边框渲染 */
    .card, .tool-card, .btn {
        border-width: 0.5px;
    }
}

/* 横屏设备优化 */
@media (orientation: landscape) and (max-height: 600px) {
    /* 横屏模式下的布局调整 */
    .music-player {
        height: 50px;
        padding: 0 var(--spacing-sm);
    }
    
    .song-cover {
        width: 35px;
        height: 35px;
    }
    
    .control-btn {
        width: 32px;
        height: 32px;
        font-size: 0.875rem;
    }
    
    .play-btn {
        width: 40px;
        height: 40px;
    }
}

/* 打印样式优化 */
@media print {
    /* 隐藏不必要的元素 */
    .music-player,
    .sidebar,
    .controls-container,
    .transparency-panel,
    .playlist-panel {
        display: none !important;
    }
    
    /* 优化文本渲染 */
    body {
        font-size: 12pt;
        line-height: 1.4;
        color: #000;
        background: #fff;
    }
    
    .article-content {
        padding: 0;
        margin: 0;
    }
    
    /* 优化链接显示 */
    a[href]:after {
        content: " (" attr(href) ")";
        font-size: 10pt;
        color: #666;
    }
}

/* 可访问性优化 */
@media (prefers-reduced-motion: reduce) {
    /* 减少动画效果 */
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
    
    /* 移除变换效果 */
    .tool-card:hover,
    .btn:hover,
    .control-btn:hover {
        transform: none !important;
    }
}

/* 高对比度模式 */
@media (prefers-contrast: high) {
    :root {
        --primary-color: #000;
        --secondary-color: #333;
        --accent-color: #000;
        --text-color: #000;
        --bg-color: #fff;
        --border-color: #000;
    }
    
    .dark {
        --text-color: #fff;
        --bg-color: #000;
        --border-color: #fff;
    }
    
    .card, .tool-card {
        border: 2px solid var(--border-color);
        background: var(--bg-color);
    }
    
    .btn {
        border: 2px solid var(--border-color);
        background: var(--bg-color);
        color: var(--text-color);
    }
}

/* 强制颜色模式 */
@media (forced-colors: active) {
    .card, .tool-card {
        border: 1px solid ButtonBorder;
        background: ButtonFace;
    }
    
    .btn {
        border: 1px solid ButtonBorder;
        background: ButtonFace;
        color: ButtonText;
    }
    
    .btn:hover {
        background: Highlight;
        color: HighlightText;
    }
}

/* 容器查询支持 (实验性) */
@supports (container-type: inline-size) {
    .tools-container {
        container-type: inline-size;
    }
    
    @container (max-width: 600px) {
        .tools-grid {
            grid-template-columns: 1fr;
        }
    }
    
    @container (min-width: 601px) and (max-width: 900px) {
        .tools-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    
    @container (min-width: 901px) {
        .tools-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }
}