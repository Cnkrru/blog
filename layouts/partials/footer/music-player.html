<!-- éŸ³ä¹æ’­æ”¾å™¨æ ·å¼ -->
<link rel="stylesheet" href="/blog/audio/css/music-player.css">

<!-- éŸ³ä¹æ’­æ”¾å™¨æ§åˆ¶æŒ‰é’® -->
<button id="music-player-toggle" class="music-player-toggle" aria-label="éŸ³ä¹æ’­æ”¾å™¨" title="éŸ³ä¹æ’­æ”¾å™¨">
  <span class="toggle-icon play-icon">â™ª</span>
  <span class="toggle-icon close-icon">Ã—</span>
</button>

<!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
<button id="theme-toggle-button" class="music-player-toggle theme-toggle-btn" aria-label="ä¸»é¢˜åˆ‡æ¢" title="ä¸»é¢˜åˆ‡æ¢">
  <span class="toggle-icon sun-icon">â˜€ï¸</span>
  <span class="toggle-icon moon-icon">ğŸŒ™</span>
</button>

<script>
// ç›´æ¥åœ¨HTMLä¸­æ·»åŠ ä¸»é¢˜åˆ‡æ¢è„šæœ¬
console.log('ä¸»é¢˜åˆ‡æ¢è„šæœ¬åŠ è½½');

// ç«‹å³æ‰§è¡Œçš„å‡½æ•°è¡¨è¾¾å¼
(function() {
  // åˆ‡æ¢ä¸»é¢˜çš„å‡½æ•°
  window.toggleTheme = function() {
    console.log('ä¸»é¢˜åˆ‡æ¢å‡½æ•°è¢«è°ƒç”¨');
    
    // è·å–æ ¹å…ƒç´ 
    const root = document.documentElement;
    
    // æ£€æŸ¥å½“å‰ä¸»é¢˜
    const isDark = root.dataset.scheme === 'dark';
    const newTheme = isDark ? 'light' : 'dark';
    
    console.log('å½“å‰ä¸»é¢˜:', isDark ? 'dark' : 'light');
    console.log('åˆ‡æ¢åˆ°:', newTheme);
    
    // æ›´æ–°data-schemeå±æ€§
    root.dataset.scheme = newTheme;
    console.log('æ›´æ–°åçš„data-scheme:', root.dataset.scheme);
    
    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
    localStorage.setItem('StackColorScheme', newTheme);
    console.log('ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨:', localStorage.getItem('StackColorScheme'));
    
    // å¼ºåˆ¶é‡æ–°æ¸²æŸ“
    setTimeout(function() {
      console.log('å¼ºåˆ¶é‡æ–°æ¸²æŸ“');
      // è§¦å‘é‡æ’
      root.style.display = 'none';
      root.offsetHeight; // è§¦å‘é‡æ’
      root.style.display = '';
    }, 50);
  };
  
  // ç­‰å¾…DOMåŠ è½½å®Œæˆ
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOMåŠ è½½å®Œæˆï¼Œç»‘å®šä¸»é¢˜åˆ‡æ¢äº‹ä»¶');
      const btn = document.getElementById('theme-toggle-button');
      if (btn) {
        console.log('æ‰¾åˆ°ä¸»é¢˜åˆ‡æ¢æŒ‰é’®:', btn);
        btn.addEventListener('click', window.toggleTheme);
        console.log('äº‹ä»¶ç›‘å¬å™¨å·²ç»‘å®š');
      } else {
        console.log('æœªæ‰¾åˆ°ä¸»é¢˜åˆ‡æ¢æŒ‰é’®');
      }
    });
  } else {
    console.log('DOMå·²åŠ è½½ï¼Œç›´æ¥ç»‘å®šä¸»é¢˜åˆ‡æ¢äº‹ä»¶');
    const btn = document.getElementById('theme-toggle-button');
    if (btn) {
      console.log('æ‰¾åˆ°ä¸»é¢˜åˆ‡æ¢æŒ‰é’®:', btn);
      btn.addEventListener('click', window.toggleTheme);
      console.log('äº‹ä»¶ç›‘å¬å™¨å·²ç»‘å®š');
    } else {
      console.log('æœªæ‰¾åˆ°ä¸»é¢˜åˆ‡æ¢æŒ‰é’®');
    }
  }
})();
</script>

<!-- å…¨å±€éŸ³ä¹æ’­æ”¾å™¨ -->
<div id="global-music-player" class="global-music-player">
  <div class="player-content">
    <div class="player-info">
      <div class="player-cover">
        <img id="player-cover" src="/blog/audio/covers/stay-with-me.jpg" alt="å°é¢" />
        <div class="cover-overlay"></div>
      </div>
      <div class="player-meta">
        <h4 id="player-title">Stay With Me</h4>
        <p id="player-artist">æœªçŸ¥è‰ºæœ¯å®¶</p>
      </div>
    </div>
    <div class="player-controls">
      <button type="button" id="player-prev" class="control-btn" aria-label="ä¸Šä¸€é¦–" title="ä¸Šä¸€é¦–">
        <span class="control-icon">â†</span>
      </button>
      <button type="button" id="player-play" class="control-btn play-btn" aria-label="æ’­æ”¾" title="æ’­æ”¾/æš‚åœ">
        <span class="control-icon play-icon">â–¶</span>
        <span class="control-icon pause-icon">â¸</span>
      </button>
      <button type="button" id="player-next" class="control-btn" aria-label="ä¸‹ä¸€é¦–" title="ä¸‹ä¸€é¦–">
        <span class="control-icon">â†’</span>
      </button>
    </div>
    <div class="player-progress">
      <div class="progress-bar">
        <div id="progress-fill" class="progress-fill"></div>
        <div id="progress-handle" class="progress-handle"></div>
      </div>
      <div class="time-display">
        <span id="current-time">0:00</span>
        <span id="total-time">0:00</span>
      </div>
    </div>
    <div class="player-volume">
      <button type="button" id="player-volume-btn" class="control-btn" aria-label="éŸ³é‡" title="éŸ³é‡æ§åˆ¶">
        <span class="control-icon volume-icon">ğŸ”Š</span>
        <span class="control-icon mute-icon">ğŸ”‡</span>
      </button>
      <div class="volume-bar">
        <div id="volume-fill" class="volume-fill"></div>
        <div id="volume-handle" class="volume-handle"></div>
      </div>
    </div>
  </div>
</div>

<!-- éŸ³ä¹æ’­æ”¾å™¨è„šæœ¬ -->
<script src="/blog/audio/js/music-player.js"></script>