<!-- èƒŒæ™¯å›¾ç‰‡ -->
{{ partial "footer/background-image.html" . }}

<!-- ä¸‰ä¸ªæ¿å—æ ·å¼ -->
{{ partial "footer/section-styles.html" . }}

<!-- å­—ä½“é¢œè‰²ä¼˜åŒ– -->
{{ partial "footer/font-colors.html" . }}

<!-- éŸ³ä¹æ’­æ”¾å™¨ï¼ˆç§»åˆ°å¯æ‰©å±•æ§åˆ¶æŒ‰é’®å®¹å™¨å¤–éƒ¨ï¼‰ -->
{{ partial "footer/music-player.html" . }}

<!-- å¯æ‰©å±•æ§åˆ¶æŒ‰é’®å®¹å™¨ -->
<div class="expandable-controls-container" style="position: fixed; bottom: 20px; right: 20px; z-index: 99999; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);">
  <div class="controls-wrapper" style="display: flex; align-items: center; gap: 12px; background: linear-gradient(135deg, rgba(255, 200, 210, 0.8), rgba(170, 210, 230, 0.8)); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 50px; padding: 8px; box-shadow: 0 4px 16px rgba(170, 210, 230, 0.4); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); width: 50px; height: 50px; overflow: hidden; flex-direction: row-reverse;">
    <!-- å±•å¼€/æ”¶èµ·ç®­å¤´ -->
    <button id="expand-toggle" class="expand-toggle" aria-label="å±•å¼€/æ”¶èµ·æ§åˆ¶æŒ‰é’®" title="å±•å¼€/æ”¶èµ·æ§åˆ¶æŒ‰é’®" style="width: 34px; height: 34px; background: transparent; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; color: #333; transition: all 0.3s ease; flex-shrink: 0;">
      <span class="expand-arrow" style="display: block; transition: transform 0.3s ease;">â˜°</span>
    </button>
    
    <!-- æ§åˆ¶æŒ‰é’® -->
    <div class="control-buttons" style="display: flex; gap: 16px; transition: all 0.3s ease; transform: translateX(-20px); opacity: 0; pointer-events: none;">
      <!-- éŸ³ä¹æ’­æ”¾å™¨æ§åˆ¶æŒ‰é’® -->
      <button id="music-player-toggle" class="music-player-toggle control-button" aria-label="éŸ³ä¹æ’­æ”¾å™¨" title="éŸ³ä¹æ’­æ”¾å™¨" style="width: 34px; height: 34px; background: transparent; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; color: #333; transition: all 0.3s ease;">
        <span class="toggle-icon play-icon" style="display: block; transition: all 0.3s ease;">â™ª</span>
        <span class="toggle-icon close-icon" style="display: none; transition: all 0.3s ease; font-size: 16px; font-weight: bold;">Ã—</span>
      </button>
      
      <!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
      {{ partial "footer/theme-toggle.html" . }}
      
      <!-- æ²‰æµ¸é˜…è¯»æŒ‰é’® -->
      <button id="immersive-reading-button" class="immersive-reading-button control-button" aria-label="æ²‰æµ¸é˜…è¯»" title="æ²‰æµ¸é˜…è¯»" style="width: 34px; height: 34px; background: transparent; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; color: #333; transition: all 0.3s ease;">
        <span class="immersive-icon book-icon" style="display: block; transition: all 0.3s ease;">ğŸ“–</span>
        <span class="immersive-icon exit-icon" style="display: none; transition: all 0.3s ease;">Ã—</span>
      </button>
    </div>
  </div>
</div>

<script>
// å±•å¼€/æ”¶èµ·æ§åˆ¶è„šæœ¬
document.addEventListener('DOMContentLoaded', function() {
  const expandToggle = document.getElementById('expand-toggle');
  const controlButtons = document.querySelector('.control-buttons');
  const expandArrow = document.querySelector('.expand-arrow');
  const controlsWrapper = document.querySelector('.controls-wrapper');
  
  let isExpanded = false;
  
  expandToggle.addEventListener('click', function() {
    isExpanded = !isExpanded;
    
    if (isExpanded) {
      // å±•å¼€çŠ¶æ€
      expandArrow.textContent = 'âœ•';
      controlsWrapper.style.width = 'auto';
      controlsWrapper.style.minWidth = '180px';
      controlsWrapper.style.borderRadius = '25px';
      controlButtons.style.transform = 'translateX(0)';
      controlButtons.style.opacity = '1';
      controlButtons.style.pointerEvents = 'auto';
    } else {
      // æ”¶èµ·çŠ¶æ€
      expandArrow.textContent = 'â˜°';
      controlsWrapper.style.width = '50px';
      controlsWrapper.style.minWidth = '50px';
      controlsWrapper.style.borderRadius = '50px';
      controlButtons.style.transform = 'translateX(-20px)';
      controlButtons.style.opacity = '0';
      controlButtons.style.pointerEvents = 'none';
    }
  });

  // åˆå§‹çŠ¶æ€ï¼šæ”¶èµ·ï¼ˆåœ†å½¢ï¼‰
  isExpanded = false;
  expandArrow.textContent = 'â˜°';
  controlsWrapper.style.width = '50px';
  controlsWrapper.style.minWidth = '50px';
  controlsWrapper.style.borderRadius = '50px';
  controlButtons.style.transform = 'translateX(-20px)';
  controlButtons.style.opacity = '0';
  controlButtons.style.pointerEvents = 'none';
});

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
window.addEventListener('load', function() {
  initImmersiveReading();
});
</script>